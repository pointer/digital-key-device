/*! *********************************************************************************
* Copyright 2023 Sofiatech - Jawhar KEBEILI
* All rights reserved.
*
* \file
*
* SPDX-License-Identifier: BSD-3-Clause
********************************************************************************** */

#ifndef KEYFOB_MANAGER_H 
#define KEYFOB_MANAGER_H 

#ifdef __cplusplus
extern "C" {
#endif

/************************************************************************************
*************************************************************************************
* Includes
*************************************************************************************
************************************************************************************/
#include "EmbeddedTypes.h"

/************************************************************************************
*************************************************************************************
* Public types
*************************************************************************************
************************************************************************************/
typedef enum
{
  KEYFOB_EVENT_INIT_FINISHED = 0,
  KEYFOB_EVENT_WALK_DETECTED,
  KEYFOB_EVENT_MOTION_STILL_DETECTED,
  KEYFOB_EVENT_BUTTON_ACTIVATED,
  KEYFOB_EVENT_SLOW_SCAN_TIMEOUT,
  KEYFOB_EVENT_CONNECTION_REQUEST,
  KEYFOB_EVENT_FAST_SCAN_TIMEOUT,
  KEYFOB_EVENT_NO_ACC_DETECTED_AFTER_10_MIN,
  KEYFOB_EVENT_BLE_CONNECTION_SUCCESS,
  KEYFOB_EVENT_BLE_CONNECTION_FAILURE,
  KEYFOB_EVENT_BLE_CONNECTION_TIMEOUT,
  KEYFOB_EVENT_BLE_DISCONNECTED,
  KEYFOB_EVENT_ENTER_FREEZE,
  KEYFOB_EVENT_EXIT_FREEZE,
  KEYFOB_EVENT_TEST,
  KEYFOB_EVENT_MAX
}keyfob_event_t;

/************************************************************************************
*************************************************************************************
* Public Macros
*************************************************************************************
************************************************************************************/
#define conversion_percent_to_voltage(percent)       (1800 +(12*(float)percent))/1000
/************************************************************************************
*************************************************************************************
* Public memory declarations
*************************************************************************************
********************************************************************************** */


/************************************************************************************
*************************************************************************************
* Public functions
*************************************************************************************
************************************************************************************/
void KEYFOB_MGR_init(void);
void KEYFOB_MGR_run(void);
void KEYFOB_MGR_notify(uint32_t u32Event);
void KEYFOB_wake_up(void);
void _keyfob_go_to_sleep(void);

#ifdef __cplusplus
}
#endif

#endif /* KEYFOB_MANAGER_H  */

/*! *********************************************************************************
* @}
********************************************************************************** */
